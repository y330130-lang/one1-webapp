export const config={runtime:"nodejs18.x"};import crypto from "node:crypto";function cors(e){e.setHeader("Access-Control-Allow-Origin","*"),e.setHeader("Access-Control-Allow-Methods","GET,POST,OPTIONS"),e.setHeader("Access-Control-Allow-Headers","Content-Type, x-ak, x-sk")}export default async function handler(e,s){if(cors(s),"OPTIONS"===e.method)return s.status(200).end();try{const r=e.headers["x-ak"],t=e.headers["x-sk"];if(!r||!t)return s.status(400).json({ok:!1,error:"missing-headers"});const n={access_token:r,nonce:Date.now()},o=Buffer.from(JSON.stringify(n)).toString("base64"),a=(await import("node:crypto")).createHmac("sha512",t).update(o).digest("hex"),c=await fetch("https://api.coinone.co.kr/v2/account/balance/",{method:"POST",headers:{"Content-Type":"application/json","X-COINONE-PAYLOAD":o,"X-COINONE-SIGNATURE":a},body:JSON.stringify(n)}),i=await c.json();return s.status(200).json({ok:!0,coinone:i})}catch(e){return s.status(500).json({ok:!1,error:"server-error",message:String(e)})}}